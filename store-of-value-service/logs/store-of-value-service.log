2025-04-30 09:09:42.558 INFO  [main] t.c.s.AnnotationConfigContextLoaderUtils : Could not detect default configuration classes for test class [com.ibrahim.banking.store_of_value_service.repository.AccountRepositoryTest]: AccountRepositoryTest does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2025-04-30 09:09:42.633 INFO  [main] .b.t.c.SpringBootTestContextBootstrapper : Found @SpringBootConfiguration com.ibrahim.banking.store_of_value_service.StoreOfValueServiceApplication for test class com.ibrahim.banking.store_of_value_service.repository.AccountRepositoryTest
2025-04-30 09:09:42.798 INFO  [background-preinit] o.h.validator.internal.util.Version      : HV000001: Hibernate Validator 8.0.2.Final
2025-04-30 09:09:42.823 INFO  [main] c.i.b.s.r.AccountRepositoryTest          : Starting AccountRepositoryTest using Java 17.0.7 with PID 46647 (started by ibrahimdiba in /Users/ibrahimdiba/Desktop/Projects/banking-system/store-of-value-service)
2025-04-30 09:09:42.823 INFO  [main] c.i.b.s.r.AccountRepositoryTest          : No active profile set, falling back to 1 default profile: "default"
2025-04-30 09:09:43.021 INFO  [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
2025-04-30 09:09:43.022 INFO  [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-04-30 09:09:43.112 INFO  [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 82 ms. Found 1 JPA repository interface.
2025-04-30 09:09:43.140 INFO  [main] beddedDataSourceBeanFactoryPostProcessor : Replacing 'dataSource' DataSource bean with embedded version
2025-04-30 09:09:43.193 INFO  [main] o.s.j.d.e.EmbeddedDatabaseFactory        : Starting embedded database: url='jdbc:h2:mem:4f17457f-28e0-4541-8f43-0551cdfe3ce6;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=false', username='sa'
2025-04-30 09:09:43.427 INFO  [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2025-04-30 09:09:43.470 INFO  [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.6.13.Final
2025-04-30 09:09:43.492 INFO  [main] o.h.c.internal.RegionFactoryInitiator    : HHH000026: Second-level cache disabled
2025-04-30 09:09:43.646 INFO  [main] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2025-04-30 09:09:43.675 WARN  [main] org.hibernate.dialect.Dialect            : HHH000511: The 2.3.232 version for [org.hibernate.dialect.PostgreSQLDialect] is no longer supported, hence certain features may not work properly. The minimum supported version is 12.0.0. Check the community dialects project for available legacy versions.
2025-04-30 09:09:43.681 WARN  [main] org.hibernate.orm.deprecation            : HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-04-30 09:09:43.692 INFO  [main] org.hibernate.orm.connections.pooling    : HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'org.springframework.jdbc.datasource.embedded.EmbeddedDatabaseFactory$EmbeddedDataSourceProxy@7e2bc2f4']
	Database driver: undefined/unknown
	Database version: 2.3.232
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-04-30 09:09:44.152 INFO  [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-04-30 09:09:44.193 INFO  [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-04-30 09:09:44.374 INFO  [main] c.i.b.s.r.AccountRepositoryTest          : Started AccountRepositoryTest in 1.703 seconds (process running for 2.301)
2025-04-30 09:09:44.843 INFO  [main] t.c.s.AnnotationConfigContextLoaderUtils : Could not detect default configuration classes for test class [com.ibrahim.banking.store_of_value_service.StoreOfValueServiceApplicationTests]: StoreOfValueServiceApplicationTests does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2025-04-30 09:09:44.848 INFO  [main] .b.t.c.SpringBootTestContextBootstrapper : Found @SpringBootConfiguration com.ibrahim.banking.store_of_value_service.StoreOfValueServiceApplication for test class com.ibrahim.banking.store_of_value_service.StoreOfValueServiceApplicationTests
2025-04-30 09:09:44.885 INFO  [main] .b.s.StoreOfValueServiceApplicationTests : Starting StoreOfValueServiceApplicationTests using Java 17.0.7 with PID 46647 (started by ibrahimdiba in /Users/ibrahimdiba/Desktop/Projects/banking-system/store-of-value-service)
2025-04-30 09:09:44.886 INFO  [main] .b.s.StoreOfValueServiceApplicationTests : No active profile set, falling back to 1 default profile: "default"
2025-04-30 09:09:45.104 INFO  [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
2025-04-30 09:09:45.105 INFO  [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-04-30 09:09:45.110 INFO  [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 4 ms. Found 1 JPA repository interface.
2025-04-30 09:09:45.116 INFO  [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
2025-04-30 09:09:45.117 INFO  [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-04-30 09:09:45.124 INFO  [main] .RepositoryConfigurationExtensionSupport : Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.ibrahim.banking.store_of_value_service.repository.AccountRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-04-30 09:09:45.125 INFO  [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 2 ms. Found 0 Redis repository interfaces.
2025-04-30 09:09:45.285 INFO  [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2025-04-30 09:09:45.286 INFO  [main] o.h.c.internal.RegionFactoryInitiator    : HHH000026: Second-level cache disabled
2025-04-30 09:09:45.290 INFO  [main] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2025-04-30 09:09:45.291 INFO  [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-04-30 09:09:45.457 INFO  [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@3459ccd9
2025-04-30 09:09:45.459 INFO  [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-04-30 09:09:45.492 WARN  [main] org.hibernate.orm.deprecation            : HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-04-30 09:09:45.498 INFO  [main] org.hibernate.orm.connections.pooling    : HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 14.17
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-04-30 09:09:45.514 INFO  [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-04-30 09:09:45.572 INFO  [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-04-30 09:09:45.659 WARN  [main] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-04-30 09:09:46.281 INFO  [main] .b.s.StoreOfValueServiceApplicationTests : Started StoreOfValueServiceApplicationTests in 1.426 seconds (process running for 4.208)
2025-04-30 09:09:46.429 INFO  [main] o.s.mock.web.MockServletContext          : Initializing Spring TestDispatcherServlet ''
2025-04-30 09:09:46.429 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-04-30 09:09:46.429 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 0 ms
2025-04-30 09:09:46.503 ERROR [main] c.i.b.s.e.GlobalExceptionHandler         : Unhandled Exception: Unexpected database error
java.lang.RuntimeException: Unexpected database error
	at com.ibrahim.banking.store_of_value_service.service.AccountService.activateAccount(AccountService.java:67)
	at com.ibrahim.banking.store_of_value_service.controller.AccountController.activateAccount(AccountController.java:51)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:888)
	at org.springframework.test.web.servlet.TestDispatcherServlet.service(TestDispatcherServlet.java:72)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.springframework.mock.web.MockFilterChain$ServletFilterProxy.doFilter(MockFilterChain.java:165)
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:132)
	at org.springframework.test.web.servlet.MockMvc.perform(MockMvc.java:201)
	at com.ibrahim.banking.store_of_value_service.controller.AccountControllerWithExceptionHandlerTest.activateAccount_ServerError_ShouldReturnProperErrorResponse(AccountControllerWithExceptionHandlerTest.java:153)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:767)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:156)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:147)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:86)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(InterceptingExecutableInvoker.java:103)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.lambda$invoke$0(InterceptingExecutableInvoker.java:93)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:92)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:86)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$8(TestMethodTestDescriptor.java:217)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:213)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:138)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:68)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:156)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:160)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:160)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:198)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:169)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:93)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:58)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:141)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:57)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:103)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:85)
	at org.junit.platform.launcher.core.DelegatingLauncher.execute(DelegatingLauncher.java:47)
	at org.apache.maven.surefire.junitplatform.LazyLauncher.execute(LazyLauncher.java:56)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.execute(JUnitPlatformProvider.java:194)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:150)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:124)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:385)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:162)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:507)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:495)
2025-04-30 09:09:46.582 INFO  [main] o.s.mock.web.MockServletContext          : Initializing Spring TestDispatcherServlet ''
2025-04-30 09:09:46.582 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-04-30 09:09:46.582 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 0 ms
2025-04-30 09:09:46.587 ERROR [main] c.i.b.s.e.GlobalExceptionHandler         : AccountNotFoundException: Account not found with number: nonexistent
2025-04-30 09:09:46.609 INFO  [main] o.s.mock.web.MockServletContext          : Initializing Spring TestDispatcherServlet ''
2025-04-30 09:09:46.610 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-04-30 09:09:46.611 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 1 ms
2025-04-30 09:09:46.745 ERROR [main] c.i.b.s.e.GlobalExceptionHandler         : MethodArgumentNotValidException: Validation failed: {accountType=Account type cannot be null}
2025-04-30 09:09:46.773 INFO  [main] o.s.mock.web.MockServletContext          : Initializing Spring TestDispatcherServlet ''
2025-04-30 09:09:46.773 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-04-30 09:09:46.773 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 0 ms
2025-04-30 09:09:46.785 ERROR [main] c.i.b.s.e.GlobalExceptionHandler         : MethodArgumentNotValidException: Validation failed: {profileId=Profile ID cannot be blank, accountType=Account type cannot be null}
2025-04-30 09:09:46.800 INFO  [main] o.s.mock.web.MockServletContext          : Initializing Spring TestDispatcherServlet ''
2025-04-30 09:09:46.800 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-04-30 09:09:46.800 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 0 ms
2025-04-30 09:09:46.804 ERROR [main] c.i.b.s.e.GlobalExceptionHandler         : Unhandled Exception: Account is not active.
java.lang.IllegalStateException: Account is not active.
	at com.ibrahim.banking.store_of_value_service.service.AccountService.getBalance(AccountService.java:52)
	at com.ibrahim.banking.store_of_value_service.controller.AccountController.getBalance(AccountController.java:44)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at org.springframework.test.web.servlet.TestDispatcherServlet.service(TestDispatcherServlet.java:72)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.springframework.mock.web.MockFilterChain$ServletFilterProxy.doFilter(MockFilterChain.java:165)
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:132)
	at org.springframework.test.web.servlet.MockMvc.perform(MockMvc.java:201)
	at com.ibrahim.banking.store_of_value_service.controller.AccountControllerWithExceptionHandlerTest.getBalance_IllegalState_ShouldReturnProperErrorResponse(AccountControllerWithExceptionHandlerTest.java:112)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:767)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:156)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:147)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:86)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(InterceptingExecutableInvoker.java:103)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.lambda$invoke$0(InterceptingExecutableInvoker.java:93)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:92)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:86)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$8(TestMethodTestDescriptor.java:217)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:213)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:138)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:68)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:156)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:160)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:160)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:198)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:169)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:93)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:58)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:141)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:57)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:103)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:85)
	at org.junit.platform.launcher.core.DelegatingLauncher.execute(DelegatingLauncher.java:47)
	at org.apache.maven.surefire.junitplatform.LazyLauncher.execute(LazyLauncher.java:56)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.execute(JUnitPlatformProvider.java:194)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:150)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:124)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:385)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:162)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:507)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:495)
2025-04-30 09:09:46.836 INFO  [main] o.s.mock.web.MockServletContext          : Initializing Spring TestDispatcherServlet ''
2025-04-30 09:09:46.837 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-04-30 09:09:46.837 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 0 ms
2025-04-30 09:09:46.882 INFO  [main] o.s.mock.web.MockServletContext          : Initializing Spring TestDispatcherServlet ''
2025-04-30 09:09:46.882 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-04-30 09:09:46.882 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 0 ms
2025-04-30 09:09:46.906 INFO  [main] o.s.mock.web.MockServletContext          : Initializing Spring TestDispatcherServlet ''
2025-04-30 09:09:46.906 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-04-30 09:09:46.906 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 0 ms
2025-04-30 09:09:46.924 INFO  [main] o.s.mock.web.MockServletContext          : Initializing Spring TestDispatcherServlet ''
2025-04-30 09:09:46.924 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-04-30 09:09:46.925 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 1 ms
2025-04-30 09:09:46.944 INFO  [main] o.s.mock.web.MockServletContext          : Initializing Spring TestDispatcherServlet ''
2025-04-30 09:09:46.945 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-04-30 09:09:46.945 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 0 ms
2025-04-30 09:09:46.954 WARN  [main] .w.s.m.s.DefaultHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.ibrahim.banking.store_of_value_service.dto.AccountResponse> com.ibrahim.banking.store_of_value_service.controller.AccountController.createAccount(com.ibrahim.banking.store_of_value_service.dto.CreateAccountRequest) with 2 errors: [Field error in object 'createAccountRequest' on field 'profileId': rejected value [null]; codes [NotBlank.createAccountRequest.profileId,NotBlank.profileId,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [createAccountRequest.profileId,profileId]; arguments []; default message [profileId]]; default message [Profile ID cannot be blank]] [Field error in object 'createAccountRequest' on field 'accountType': rejected value [null]; codes [NotNull.createAccountRequest.accountType,NotNull.accountType,NotNull.com.ibrahim.banking.store_of_value_service.model.AccountType,NotNull]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [createAccountRequest.accountType,accountType]; arguments []; default message [accountType]]; default message [Account type cannot be null]] ]
2025-04-30 09:09:46.966 INFO  [main] o.s.mock.web.MockServletContext          : Initializing Spring TestDispatcherServlet ''
2025-04-30 09:09:46.966 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-04-30 09:09:46.967 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 1 ms
2025-04-30 09:09:46.981 INFO  [main] o.s.mock.web.MockServletContext          : Initializing Spring TestDispatcherServlet ''
2025-04-30 09:09:46.981 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-04-30 09:09:46.981 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 0 ms
2025-04-30 09:09:46.999 INFO  [main] o.s.mock.web.MockServletContext          : Initializing Spring TestDispatcherServlet ''
2025-04-30 09:09:46.999 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-04-30 09:09:46.999 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 0 ms
2025-04-30 09:09:47.014 INFO  [main] o.s.mock.web.MockServletContext          : Initializing Spring TestDispatcherServlet ''
2025-04-30 09:09:47.014 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-04-30 09:09:47.014 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 0 ms
2025-04-30 09:09:47.030 INFO  [main] o.s.mock.web.MockServletContext          : Initializing Spring TestDispatcherServlet ''
2025-04-30 09:09:47.030 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-04-30 09:09:47.030 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 0 ms
2025-04-30 09:09:47.047 INFO  [main] t.c.s.AnnotationConfigContextLoaderUtils : Could not detect default configuration classes for test class [com.ibrahim.banking.store_of_value_service.controller.AccountControllerSecurityTest]: AccountControllerSecurityTest does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2025-04-30 09:09:47.073 INFO  [main] .b.t.c.SpringBootTestContextBootstrapper : Found @SpringBootConfiguration com.ibrahim.banking.store_of_value_service.StoreOfValueServiceApplication for test class com.ibrahim.banking.store_of_value_service.controller.AccountControllerSecurityTest
2025-04-30 09:09:47.098 INFO  [main] c.i.b.s.c.AccountControllerSecurityTest  : Starting AccountControllerSecurityTest using Java 17.0.7 with PID 46647 (started by ibrahimdiba in /Users/ibrahimdiba/Desktop/Projects/banking-system/store-of-value-service)
2025-04-30 09:09:47.099 INFO  [main] c.i.b.s.c.AccountControllerSecurityTest  : No active profile set, falling back to 1 default profile: "default"
2025-04-30 09:09:47.346 WARN  [main] .s.s.UserDetailsServiceAutoConfiguration : 

Using generated security password: d93c412e-d9a7-4a5f-be63-e66e2d5221ad

This generated password is for development use only. Your security configuration must be updated before running your application in production.

2025-04-30 09:09:47.354 INFO  [main] r$InitializeUserDetailsManagerConfigurer : Global AuthenticationManager configured with UserDetailsService bean with name inMemoryUserDetailsManager
2025-04-30 09:09:47.387 INFO  [main] o.s.b.t.m.w.SpringBootMockServletContext : Initializing Spring TestDispatcherServlet ''
2025-04-30 09:09:47.387 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-04-30 09:09:47.387 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 0 ms
2025-04-30 09:09:47.399 INFO  [main] c.i.b.s.c.AccountControllerSecurityTest  : Started AccountControllerSecurityTest in 0.323 seconds (process running for 5.327)
2025-04-30 09:09:47.591 INFO  [main] c.i.b.s.service.AccountService           : Attempting to update account type for account number: 1112223330
2025-04-30 09:09:47.591 ERROR [main] c.i.b.s.service.AccountService           : Cannot update account 1112223330 because it is closed.
2025-04-30 09:09:47.595 INFO  [main] c.i.b.s.service.AccountService           : Attempting to activate account number: 1112223330
2025-04-30 09:09:47.595 ERROR [main] c.i.b.s.service.AccountService           : Cannot activate account 1112223330 in state: INACTIVE
2025-04-30 09:09:47.599 INFO  [main] c.i.b.s.service.AccountService           : Attempting to update account type for account number: 1112223330
2025-04-30 09:09:47.599 INFO  [main] c.i.b.s.service.AccountService           : Account 1112223330 updated successfully.
2025-04-30 09:09:47.601 INFO  [main] c.i.b.s.service.AccountService           : Attempting to deactivate account number: 1112223330
2025-04-30 09:09:47.602 INFO  [main] c.i.b.s.service.AccountService           : Account 1112223330 deactivated successfully.
2025-04-30 09:09:47.606 INFO  [main] c.i.b.s.service.AccountService           : Attempting to create account for profileId: profile-new
2025-04-30 09:09:47.606 INFO  [main] c.i.b.s.service.AccountService           : Generated unique account number: 7639379567
2025-04-30 09:09:47.606 INFO  [main] c.i.b.s.service.AccountService           : Account created successfully with ID: 99 and Number: 7639379567
2025-04-30 09:09:47.608 INFO  [main] c.i.b.s.service.AccountService           : Attempting to activate account number: 1112223330
2025-04-30 09:09:47.608 INFO  [main] c.i.b.s.service.AccountService           : Account 1112223330 activated successfully.
2025-04-30 09:09:47.609 INFO  [main] c.i.b.s.service.AccountService           : Attempting to deactivate account number: 1112223330
2025-04-30 09:09:47.609 WARN  [main] c.i.b.s.service.AccountService           : Account 1112223330 is already inactive. Returning current state.
2025-04-30 09:09:47.611 INFO  [main] c.i.b.s.service.AccountService           : Attempting to activate account number: 1112223330
2025-04-30 09:09:47.611 WARN  [main] c.i.b.s.service.AccountService           : Account 1112223330 is already active. Returning current state.
2025-04-30 09:09:47.612 INFO  [main] c.i.b.s.service.AccountService           : Attempting to activate account number: 0000000000
2025-04-30 09:09:47.616 INFO  [main] c.i.b.s.service.AccountService           : Attempting to deactivate account number: 0000000000
2025-04-30 09:09:47.617 INFO  [main] c.i.b.s.service.AccountService           : Attempting to deactivate account number: 1112223330
2025-04-30 09:09:47.617 ERROR [main] c.i.b.s.service.AccountService           : Cannot deactivate account 1112223330 in state: PENDING_ACTIVATION
2025-04-30 09:09:47.619 INFO  [main] c.i.b.s.service.AccountService           : Attempting to update account type for account number: 0000000000
2025-04-30 09:09:47.636 INFO  [SpringApplicationShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2025-04-30 09:09:47.646 INFO  [SpringApplicationShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2025-04-30 09:09:47.647 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2025-04-30 09:09:47.650 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2025-04-30 09:11:24.074 INFO  [main] t.c.s.AnnotationConfigContextLoaderUtils : Could not detect default configuration classes for test class [com.ibrahim.banking.store_of_value_service.repository.AccountRepositoryTest]: AccountRepositoryTest does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2025-04-30 09:11:24.150 INFO  [main] .b.t.c.SpringBootTestContextBootstrapper : Found @SpringBootConfiguration com.ibrahim.banking.store_of_value_service.StoreOfValueServiceApplication for test class com.ibrahim.banking.store_of_value_service.repository.AccountRepositoryTest
2025-04-30 09:11:24.307 INFO  [background-preinit] o.h.validator.internal.util.Version      : HV000001: Hibernate Validator 8.0.2.Final
2025-04-30 09:11:24.332 INFO  [main] c.i.b.s.r.AccountRepositoryTest          : Starting AccountRepositoryTest using Java 17.0.7 with PID 46853 (started by ibrahimdiba in /Users/ibrahimdiba/Desktop/Projects/banking-system/store-of-value-service)
2025-04-30 09:11:24.333 INFO  [main] c.i.b.s.r.AccountRepositoryTest          : No active profile set, falling back to 1 default profile: "default"
2025-04-30 09:11:24.510 INFO  [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
2025-04-30 09:11:24.511 INFO  [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-04-30 09:11:24.595 INFO  [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 77 ms. Found 1 JPA repository interface.
2025-04-30 09:11:24.622 INFO  [main] beddedDataSourceBeanFactoryPostProcessor : Replacing 'dataSource' DataSource bean with embedded version
2025-04-30 09:11:24.664 INFO  [main] o.s.j.d.e.EmbeddedDatabaseFactory        : Starting embedded database: url='jdbc:h2:mem:ef8f1671-fc8f-469e-bca0-686364da853e;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=false', username='sa'
2025-04-30 09:11:24.819 INFO  [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2025-04-30 09:11:24.848 INFO  [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.6.13.Final
2025-04-30 09:11:24.867 INFO  [main] o.h.c.internal.RegionFactoryInitiator    : HHH000026: Second-level cache disabled
2025-04-30 09:11:24.998 INFO  [main] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2025-04-30 09:11:25.025 WARN  [main] org.hibernate.dialect.Dialect            : HHH000511: The 2.3.232 version for [org.hibernate.dialect.PostgreSQLDialect] is no longer supported, hence certain features may not work properly. The minimum supported version is 12.0.0. Check the community dialects project for available legacy versions.
2025-04-30 09:11:25.028 WARN  [main] org.hibernate.orm.deprecation            : HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-04-30 09:11:25.040 INFO  [main] org.hibernate.orm.connections.pooling    : HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'org.springframework.jdbc.datasource.embedded.EmbeddedDatabaseFactory$EmbeddedDataSourceProxy@7e2bc2f4']
	Database driver: undefined/unknown
	Database version: 2.3.232
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-04-30 09:11:25.455 INFO  [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-04-30 09:11:25.486 INFO  [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-04-30 09:11:25.677 INFO  [main] c.i.b.s.r.AccountRepositoryTest          : Started AccountRepositoryTest in 1.49 seconds (process running for 2.147)
2025-04-30 09:11:26.108 INFO  [main] t.c.s.AnnotationConfigContextLoaderUtils : Could not detect default configuration classes for test class [com.ibrahim.banking.store_of_value_service.StoreOfValueServiceApplicationTests]: StoreOfValueServiceApplicationTests does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2025-04-30 09:11:26.113 INFO  [main] .b.t.c.SpringBootTestContextBootstrapper : Found @SpringBootConfiguration com.ibrahim.banking.store_of_value_service.StoreOfValueServiceApplication for test class com.ibrahim.banking.store_of_value_service.StoreOfValueServiceApplicationTests
2025-04-30 09:11:26.134 INFO  [main] .b.s.StoreOfValueServiceApplicationTests : Starting StoreOfValueServiceApplicationTests using Java 17.0.7 with PID 46853 (started by ibrahimdiba in /Users/ibrahimdiba/Desktop/Projects/banking-system/store-of-value-service)
2025-04-30 09:11:26.135 INFO  [main] .b.s.StoreOfValueServiceApplicationTests : No active profile set, falling back to 1 default profile: "default"
2025-04-30 09:11:26.330 INFO  [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
2025-04-30 09:11:26.330 INFO  [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-04-30 09:11:26.336 INFO  [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 4 ms. Found 1 JPA repository interface.
2025-04-30 09:11:26.342 INFO  [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
2025-04-30 09:11:26.342 INFO  [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-04-30 09:11:26.350 INFO  [main] .RepositoryConfigurationExtensionSupport : Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.ibrahim.banking.store_of_value_service.repository.AccountRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-04-30 09:11:26.350 INFO  [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 2 ms. Found 0 Redis repository interfaces.
2025-04-30 09:11:26.504 INFO  [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2025-04-30 09:11:26.512 INFO  [main] o.h.c.internal.RegionFactoryInitiator    : HHH000026: Second-level cache disabled
2025-04-30 09:11:26.517 INFO  [main] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2025-04-30 09:11:26.518 INFO  [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-04-30 09:11:26.655 INFO  [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@3459ccd9
2025-04-30 09:11:26.656 INFO  [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-04-30 09:11:26.668 WARN  [main] org.hibernate.orm.deprecation            : HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-04-30 09:11:26.672 INFO  [main] org.hibernate.orm.connections.pooling    : HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 14.17
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-04-30 09:11:26.688 INFO  [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-04-30 09:11:26.714 INFO  [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-04-30 09:11:26.794 WARN  [main] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-04-30 09:11:27.360 INFO  [main] .b.s.StoreOfValueServiceApplicationTests : Started StoreOfValueServiceApplicationTests in 1.24 seconds (process running for 3.83)
2025-04-30 09:11:27.493 INFO  [main] o.s.mock.web.MockServletContext          : Initializing Spring TestDispatcherServlet ''
2025-04-30 09:11:27.494 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-04-30 09:11:27.494 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 0 ms
2025-04-30 09:11:27.549 ERROR [main] c.i.b.s.e.GlobalExceptionHandler         : Unhandled Exception: Unexpected database error
java.lang.RuntimeException: Unexpected database error
	at com.ibrahim.banking.store_of_value_service.service.AccountService.activateAccount(AccountService.java:67)
	at com.ibrahim.banking.store_of_value_service.controller.AccountController.activateAccount(AccountController.java:51)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:888)
	at org.springframework.test.web.servlet.TestDispatcherServlet.service(TestDispatcherServlet.java:72)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.springframework.mock.web.MockFilterChain$ServletFilterProxy.doFilter(MockFilterChain.java:165)
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:132)
	at org.springframework.test.web.servlet.MockMvc.perform(MockMvc.java:201)
	at com.ibrahim.banking.store_of_value_service.controller.AccountControllerWithExceptionHandlerTest.activateAccount_ServerError_ShouldReturnProperErrorResponse(AccountControllerWithExceptionHandlerTest.java:153)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:767)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:156)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:147)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:86)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(InterceptingExecutableInvoker.java:103)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.lambda$invoke$0(InterceptingExecutableInvoker.java:93)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:92)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:86)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$8(TestMethodTestDescriptor.java:217)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:213)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:138)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:68)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:156)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:160)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:160)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:198)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:169)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:93)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:58)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:141)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:57)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:103)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:85)
	at org.junit.platform.launcher.core.DelegatingLauncher.execute(DelegatingLauncher.java:47)
	at org.apache.maven.surefire.junitplatform.LazyLauncher.execute(LazyLauncher.java:56)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.execute(JUnitPlatformProvider.java:194)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:150)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:124)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:385)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:162)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:507)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:495)
2025-04-30 09:11:27.622 INFO  [main] o.s.mock.web.MockServletContext          : Initializing Spring TestDispatcherServlet ''
2025-04-30 09:11:27.622 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-04-30 09:11:27.622 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 0 ms
2025-04-30 09:11:27.625 ERROR [main] c.i.b.s.e.GlobalExceptionHandler         : AccountNotFoundException: Account not found with number: nonexistent
2025-04-30 09:11:27.637 INFO  [main] o.s.mock.web.MockServletContext          : Initializing Spring TestDispatcherServlet ''
2025-04-30 09:11:27.637 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-04-30 09:11:27.637 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 0 ms
2025-04-30 09:11:27.683 ERROR [main] c.i.b.s.e.GlobalExceptionHandler         : MethodArgumentNotValidException: Validation failed: {accountType=Account type cannot be null}
2025-04-30 09:11:27.698 INFO  [main] o.s.mock.web.MockServletContext          : Initializing Spring TestDispatcherServlet ''
2025-04-30 09:11:27.699 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-04-30 09:11:27.699 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 0 ms
2025-04-30 09:11:27.706 ERROR [main] c.i.b.s.e.GlobalExceptionHandler         : MethodArgumentNotValidException: Validation failed: {profileId=Profile ID cannot be blank, accountType=Account type cannot be null}
2025-04-30 09:11:27.717 INFO  [main] o.s.mock.web.MockServletContext          : Initializing Spring TestDispatcherServlet ''
2025-04-30 09:11:27.717 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-04-30 09:11:27.717 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 0 ms
2025-04-30 09:11:27.720 ERROR [main] c.i.b.s.e.GlobalExceptionHandler         : Unhandled Exception: Account is not active.
java.lang.IllegalStateException: Account is not active.
	at com.ibrahim.banking.store_of_value_service.service.AccountService.getBalance(AccountService.java:52)
	at com.ibrahim.banking.store_of_value_service.controller.AccountController.getBalance(AccountController.java:44)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at org.springframework.test.web.servlet.TestDispatcherServlet.service(TestDispatcherServlet.java:72)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.springframework.mock.web.MockFilterChain$ServletFilterProxy.doFilter(MockFilterChain.java:165)
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:132)
	at org.springframework.test.web.servlet.MockMvc.perform(MockMvc.java:201)
	at com.ibrahim.banking.store_of_value_service.controller.AccountControllerWithExceptionHandlerTest.getBalance_IllegalState_ShouldReturnProperErrorResponse(AccountControllerWithExceptionHandlerTest.java:112)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:767)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:156)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:147)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:86)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(InterceptingExecutableInvoker.java:103)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.lambda$invoke$0(InterceptingExecutableInvoker.java:93)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:92)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:86)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$8(TestMethodTestDescriptor.java:217)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:213)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:138)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:68)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:156)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:160)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:160)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:198)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:169)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:93)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:58)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:141)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:57)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:103)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:85)
	at org.junit.platform.launcher.core.DelegatingLauncher.execute(DelegatingLauncher.java:47)
	at org.apache.maven.surefire.junitplatform.LazyLauncher.execute(LazyLauncher.java:56)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.execute(JUnitPlatformProvider.java:194)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:150)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:124)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:385)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:162)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:507)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:495)
2025-04-30 09:11:27.743 INFO  [main] o.s.mock.web.MockServletContext          : Initializing Spring TestDispatcherServlet ''
2025-04-30 09:11:27.743 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-04-30 09:11:27.743 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 0 ms
2025-04-30 09:11:27.768 INFO  [main] o.s.mock.web.MockServletContext          : Initializing Spring TestDispatcherServlet ''
2025-04-30 09:11:27.768 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-04-30 09:11:27.768 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 0 ms
2025-04-30 09:11:27.782 INFO  [main] o.s.mock.web.MockServletContext          : Initializing Spring TestDispatcherServlet ''
2025-04-30 09:11:27.782 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-04-30 09:11:27.782 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 0 ms
2025-04-30 09:11:27.795 INFO  [main] o.s.mock.web.MockServletContext          : Initializing Spring TestDispatcherServlet ''
2025-04-30 09:11:27.795 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-04-30 09:11:27.795 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 0 ms
2025-04-30 09:11:27.809 INFO  [main] o.s.mock.web.MockServletContext          : Initializing Spring TestDispatcherServlet ''
2025-04-30 09:11:27.809 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-04-30 09:11:27.809 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 0 ms
2025-04-30 09:11:27.814 WARN  [main] .w.s.m.s.DefaultHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.ibrahim.banking.store_of_value_service.dto.AccountResponse> com.ibrahim.banking.store_of_value_service.controller.AccountController.createAccount(com.ibrahim.banking.store_of_value_service.dto.CreateAccountRequest) with 2 errors: [Field error in object 'createAccountRequest' on field 'profileId': rejected value [null]; codes [NotBlank.createAccountRequest.profileId,NotBlank.profileId,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [createAccountRequest.profileId,profileId]; arguments []; default message [profileId]]; default message [Profile ID cannot be blank]] [Field error in object 'createAccountRequest' on field 'accountType': rejected value [null]; codes [NotNull.createAccountRequest.accountType,NotNull.accountType,NotNull.com.ibrahim.banking.store_of_value_service.model.AccountType,NotNull]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [createAccountRequest.accountType,accountType]; arguments []; default message [accountType]]; default message [Account type cannot be null]] ]
2025-04-30 09:11:27.822 INFO  [main] o.s.mock.web.MockServletContext          : Initializing Spring TestDispatcherServlet ''
2025-04-30 09:11:27.822 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-04-30 09:11:27.822 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 0 ms
2025-04-30 09:11:27.840 INFO  [main] o.s.mock.web.MockServletContext          : Initializing Spring TestDispatcherServlet ''
2025-04-30 09:11:27.840 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-04-30 09:11:27.840 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 0 ms
2025-04-30 09:11:27.852 INFO  [main] o.s.mock.web.MockServletContext          : Initializing Spring TestDispatcherServlet ''
2025-04-30 09:11:27.852 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-04-30 09:11:27.852 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 0 ms
2025-04-30 09:11:27.863 INFO  [main] o.s.mock.web.MockServletContext          : Initializing Spring TestDispatcherServlet ''
2025-04-30 09:11:27.864 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-04-30 09:11:27.864 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 0 ms
2025-04-30 09:11:27.875 INFO  [main] o.s.mock.web.MockServletContext          : Initializing Spring TestDispatcherServlet ''
2025-04-30 09:11:27.875 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-04-30 09:11:27.875 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 0 ms
2025-04-30 09:11:27.887 INFO  [main] t.c.s.AnnotationConfigContextLoaderUtils : Could not detect default configuration classes for test class [com.ibrahim.banking.store_of_value_service.controller.AccountControllerSecurityTest]: AccountControllerSecurityTest does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2025-04-30 09:11:27.901 INFO  [main] .b.t.c.SpringBootTestContextBootstrapper : Found @SpringBootConfiguration com.ibrahim.banking.store_of_value_service.StoreOfValueServiceApplication for test class com.ibrahim.banking.store_of_value_service.controller.AccountControllerSecurityTest
2025-04-30 09:11:27.922 INFO  [main] c.i.b.s.c.AccountControllerSecurityTest  : Starting AccountControllerSecurityTest using Java 17.0.7 with PID 46853 (started by ibrahimdiba in /Users/ibrahimdiba/Desktop/Projects/banking-system/store-of-value-service)
2025-04-30 09:11:27.922 INFO  [main] c.i.b.s.c.AccountControllerSecurityTest  : No active profile set, falling back to 1 default profile: "default"
2025-04-30 09:11:28.111 WARN  [main] .s.s.UserDetailsServiceAutoConfiguration : 

Using generated security password: 28002b4f-b623-4bd7-a00c-1dbe656e064a

This generated password is for development use only. Your security configuration must be updated before running your application in production.

2025-04-30 09:11:28.118 INFO  [main] r$InitializeUserDetailsManagerConfigurer : Global AuthenticationManager configured with UserDetailsService bean with name inMemoryUserDetailsManager
2025-04-30 09:11:28.145 INFO  [main] o.s.b.t.m.w.SpringBootMockServletContext : Initializing Spring TestDispatcherServlet ''
2025-04-30 09:11:28.145 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-04-30 09:11:28.145 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 0 ms
2025-04-30 09:11:28.156 INFO  [main] c.i.b.s.c.AccountControllerSecurityTest  : Started AccountControllerSecurityTest in 0.253 seconds (process running for 4.626)
2025-04-30 09:11:28.322 INFO  [main] c.i.b.s.service.AccountService           : Attempting to update account type for account number: 1112223330
2025-04-30 09:11:28.322 ERROR [main] c.i.b.s.service.AccountService           : Cannot update account 1112223330 because it is closed.
2025-04-30 09:11:28.325 INFO  [main] c.i.b.s.service.AccountService           : Attempting to activate account number: 1112223330
2025-04-30 09:11:28.325 ERROR [main] c.i.b.s.service.AccountService           : Cannot activate account 1112223330 in state: INACTIVE
2025-04-30 09:11:28.327 INFO  [main] c.i.b.s.service.AccountService           : Attempting to update account type for account number: 1112223330
2025-04-30 09:11:28.327 INFO  [main] c.i.b.s.service.AccountService           : Account 1112223330 updated successfully.
2025-04-30 09:11:28.331 INFO  [main] c.i.b.s.service.AccountService           : Attempting to deactivate account number: 1112223330
2025-04-30 09:11:28.332 INFO  [main] c.i.b.s.service.AccountService           : Account 1112223330 deactivated successfully.
2025-04-30 09:11:28.338 INFO  [main] c.i.b.s.service.AccountService           : Attempting to create account for profileId: profile-new
2025-04-30 09:11:28.338 INFO  [main] c.i.b.s.service.AccountService           : Generated unique account number: 6530817970
2025-04-30 09:11:28.338 INFO  [main] c.i.b.s.service.AccountService           : Account created successfully with ID: 99 and Number: 6530817970
2025-04-30 09:11:28.340 INFO  [main] c.i.b.s.service.AccountService           : Attempting to activate account number: 1112223330
2025-04-30 09:11:28.340 INFO  [main] c.i.b.s.service.AccountService           : Account 1112223330 activated successfully.
2025-04-30 09:11:28.341 INFO  [main] c.i.b.s.service.AccountService           : Attempting to deactivate account number: 1112223330
2025-04-30 09:11:28.341 WARN  [main] c.i.b.s.service.AccountService           : Account 1112223330 is already inactive. Returning current state.
2025-04-30 09:11:28.342 INFO  [main] c.i.b.s.service.AccountService           : Attempting to activate account number: 1112223330
2025-04-30 09:11:28.342 WARN  [main] c.i.b.s.service.AccountService           : Account 1112223330 is already active. Returning current state.
2025-04-30 09:11:28.343 INFO  [main] c.i.b.s.service.AccountService           : Attempting to activate account number: 0000000000
2025-04-30 09:11:28.346 INFO  [main] c.i.b.s.service.AccountService           : Attempting to deactivate account number: 0000000000
2025-04-30 09:11:28.347 INFO  [main] c.i.b.s.service.AccountService           : Attempting to deactivate account number: 1112223330
2025-04-30 09:11:28.347 ERROR [main] c.i.b.s.service.AccountService           : Cannot deactivate account 1112223330 in state: PENDING_ACTIVATION
2025-04-30 09:11:28.349 INFO  [main] c.i.b.s.service.AccountService           : Attempting to update account type for account number: 0000000000
2025-04-30 09:11:28.360 INFO  [SpringApplicationShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2025-04-30 09:11:28.371 INFO  [SpringApplicationShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2025-04-30 09:11:28.372 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2025-04-30 09:11:28.374 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2025-04-30 09:11:54.721 INFO  [main] c.i.b.s.service.AccountService           : Attempting to update account type for account number: 1112223330
2025-04-30 09:11:54.724 ERROR [main] c.i.b.s.service.AccountService           : Cannot update account 1112223330 because it is closed.
2025-04-30 09:11:54.741 INFO  [main] c.i.b.s.service.AccountService           : Attempting to activate account number: 1112223330
2025-04-30 09:11:54.742 ERROR [main] c.i.b.s.service.AccountService           : Cannot activate account 1112223330 in state: INACTIVE
2025-04-30 09:11:54.746 INFO  [main] c.i.b.s.service.AccountService           : Attempting to update account type for account number: 1112223330
2025-04-30 09:11:54.746 INFO  [main] c.i.b.s.service.AccountService           : Account 1112223330 updated successfully.
2025-04-30 09:11:54.750 INFO  [main] c.i.b.s.service.AccountService           : Attempting to deactivate account number: 1112223330
2025-04-30 09:11:54.750 INFO  [main] c.i.b.s.service.AccountService           : Account 1112223330 deactivated successfully.
2025-04-30 09:11:54.757 INFO  [main] c.i.b.s.service.AccountService           : Attempting to create account for profileId: profile-new
2025-04-30 09:11:54.757 INFO  [main] c.i.b.s.service.AccountService           : Generated unique account number: 4510247831
2025-04-30 09:11:54.757 INFO  [main] c.i.b.s.service.AccountService           : Account created successfully with ID: 99 and Number: 4510247831
2025-04-30 09:11:54.761 INFO  [main] c.i.b.s.service.AccountService           : Attempting to activate account number: 1112223330
2025-04-30 09:11:54.762 INFO  [main] c.i.b.s.service.AccountService           : Account 1112223330 activated successfully.
2025-04-30 09:11:54.764 INFO  [main] c.i.b.s.service.AccountService           : Attempting to deactivate account number: 1112223330
2025-04-30 09:11:54.764 WARN  [main] c.i.b.s.service.AccountService           : Account 1112223330 is already inactive. Returning current state.
2025-04-30 09:11:54.767 INFO  [main] c.i.b.s.service.AccountService           : Attempting to activate account number: 1112223330
2025-04-30 09:11:54.767 WARN  [main] c.i.b.s.service.AccountService           : Account 1112223330 is already active. Returning current state.
2025-04-30 09:11:54.770 INFO  [main] c.i.b.s.service.AccountService           : Attempting to activate account number: 0000000000
2025-04-30 09:11:54.775 INFO  [main] c.i.b.s.service.AccountService           : Attempting to deactivate account number: 0000000000
2025-04-30 09:11:54.778 INFO  [main] c.i.b.s.service.AccountService           : Attempting to deactivate account number: 1112223330
2025-04-30 09:11:54.778 ERROR [main] c.i.b.s.service.AccountService           : Cannot deactivate account 1112223330 in state: PENDING_ACTIVATION
2025-04-30 09:11:54.780 INFO  [main] c.i.b.s.service.AccountService           : Attempting to update account type for account number: 0000000000
2025-04-30 09:11:54.937 INFO  [main] o.h.validator.internal.util.Version      : HV000001: Hibernate Validator 8.0.2.Final
2025-04-30 09:11:55.295 INFO  [main] o.s.mock.web.MockServletContext          : Initializing Spring TestDispatcherServlet ''
2025-04-30 09:11:55.295 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-04-30 09:11:55.296 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 1 ms
2025-04-30 09:11:55.453 INFO  [main] o.s.mock.web.MockServletContext          : Initializing Spring TestDispatcherServlet ''
2025-04-30 09:11:55.453 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-04-30 09:11:55.453 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 0 ms
2025-04-30 09:11:55.479 INFO  [main] o.s.mock.web.MockServletContext          : Initializing Spring TestDispatcherServlet ''
2025-04-30 09:11:55.479 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-04-30 09:11:55.479 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 0 ms
2025-04-30 09:11:55.494 INFO  [main] o.s.mock.web.MockServletContext          : Initializing Spring TestDispatcherServlet ''
2025-04-30 09:11:55.495 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-04-30 09:11:55.495 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 0 ms
2025-04-30 09:11:55.509 INFO  [main] o.s.mock.web.MockServletContext          : Initializing Spring TestDispatcherServlet ''
2025-04-30 09:11:55.509 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-04-30 09:11:55.509 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 0 ms
2025-04-30 09:11:55.527 WARN  [main] .w.s.m.s.DefaultHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.ibrahim.banking.store_of_value_service.dto.AccountResponse> com.ibrahim.banking.store_of_value_service.controller.AccountController.createAccount(com.ibrahim.banking.store_of_value_service.dto.CreateAccountRequest) with 2 errors: [Field error in object 'createAccountRequest' on field 'accountType': rejected value [null]; codes [NotNull.createAccountRequest.accountType,NotNull.accountType,NotNull.com.ibrahim.banking.store_of_value_service.model.AccountType,NotNull]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [createAccountRequest.accountType,accountType]; arguments []; default message [accountType]]; default message [Account type cannot be null]] [Field error in object 'createAccountRequest' on field 'profileId': rejected value [null]; codes [NotBlank.createAccountRequest.profileId,NotBlank.profileId,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [createAccountRequest.profileId,profileId]; arguments []; default message [profileId]]; default message [Profile ID cannot be blank]] ]
2025-04-30 09:11:55.534 INFO  [main] o.s.mock.web.MockServletContext          : Initializing Spring TestDispatcherServlet ''
2025-04-30 09:11:55.534 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-04-30 09:11:55.534 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 0 ms
2025-04-30 09:11:55.545 INFO  [main] o.s.mock.web.MockServletContext          : Initializing Spring TestDispatcherServlet ''
2025-04-30 09:11:55.545 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-04-30 09:11:55.545 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 0 ms
2025-04-30 09:11:55.556 INFO  [main] o.s.mock.web.MockServletContext          : Initializing Spring TestDispatcherServlet ''
2025-04-30 09:11:55.557 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-04-30 09:11:55.557 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 0 ms
2025-04-30 09:11:55.567 INFO  [main] o.s.mock.web.MockServletContext          : Initializing Spring TestDispatcherServlet ''
2025-04-30 09:11:55.568 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-04-30 09:11:55.568 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 0 ms
2025-04-30 09:11:55.579 INFO  [main] o.s.mock.web.MockServletContext          : Initializing Spring TestDispatcherServlet ''
2025-04-30 09:11:55.579 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-04-30 09:11:55.579 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 0 ms
2025-04-30 09:11:55.596 INFO  [main] t.c.s.AnnotationConfigContextLoaderUtils : Could not detect default configuration classes for test class [com.ibrahim.banking.store_of_value_service.StoreOfValueServiceApplicationTests]: StoreOfValueServiceApplicationTests does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2025-04-30 09:11:55.641 INFO  [main] .b.t.c.SpringBootTestContextBootstrapper : Found @SpringBootConfiguration com.ibrahim.banking.store_of_value_service.StoreOfValueServiceApplication for test class com.ibrahim.banking.store_of_value_service.StoreOfValueServiceApplicationTests
2025-04-30 09:11:55.775 INFO  [main] .b.s.StoreOfValueServiceApplicationTests : Starting StoreOfValueServiceApplicationTests using Java 23.0.2 with PID 46952 (started by ibrahimdiba in /Users/ibrahimdiba/Desktop/Projects/banking-system/store-of-value-service)
2025-04-30 09:11:55.775 INFO  [main] .b.s.StoreOfValueServiceApplicationTests : No active profile set, falling back to 1 default profile: "default"
2025-04-30 09:11:56.099 INFO  [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
2025-04-30 09:11:56.100 INFO  [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-04-30 09:11:56.125 INFO  [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 20 ms. Found 1 JPA repository interface.
2025-04-30 09:11:56.136 INFO  [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
2025-04-30 09:11:56.137 INFO  [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-04-30 09:11:56.145 INFO  [main] .RepositoryConfigurationExtensionSupport : Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.ibrahim.banking.store_of_value_service.repository.AccountRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-04-30 09:11:56.146 INFO  [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 4 ms. Found 0 Redis repository interfaces.
2025-04-30 09:11:56.380 INFO  [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2025-04-30 09:11:56.405 INFO  [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.6.13.Final
2025-04-30 09:11:56.420 INFO  [main] o.h.c.internal.RegionFactoryInitiator    : HHH000026: Second-level cache disabled
2025-04-30 09:11:56.498 INFO  [main] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2025-04-30 09:11:56.515 INFO  [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-04-30 09:11:56.684 INFO  [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@7a3c541e
2025-04-30 09:11:56.685 INFO  [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-04-30 09:11:56.709 WARN  [main] org.hibernate.orm.deprecation            : HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-04-30 09:11:56.723 INFO  [main] org.hibernate.orm.connections.pooling    : HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 14.17
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-04-30 09:11:57.083 INFO  [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-04-30 09:11:57.124 INFO  [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-04-30 09:11:57.322 WARN  [main] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-04-30 09:11:57.843 INFO  [main] .b.s.StoreOfValueServiceApplicationTests : Started StoreOfValueServiceApplicationTests in 2.163 seconds (process running for 4.365)
2025-04-30 09:11:57.859 INFO  [main] t.c.s.AnnotationConfigContextLoaderUtils : Could not detect default configuration classes for test class [com.ibrahim.banking.store_of_value_service.repository.AccountRepositoryTest]: AccountRepositoryTest does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2025-04-30 09:11:57.870 INFO  [main] .b.t.c.SpringBootTestContextBootstrapper : Found @SpringBootConfiguration com.ibrahim.banking.store_of_value_service.StoreOfValueServiceApplication for test class com.ibrahim.banking.store_of_value_service.repository.AccountRepositoryTest
2025-04-30 09:11:57.882 INFO  [main] c.i.b.s.r.AccountRepositoryTest          : Starting AccountRepositoryTest using Java 23.0.2 with PID 46952 (started by ibrahimdiba in /Users/ibrahimdiba/Desktop/Projects/banking-system/store-of-value-service)
2025-04-30 09:11:57.882 INFO  [main] c.i.b.s.r.AccountRepositoryTest          : No active profile set, falling back to 1 default profile: "default"
2025-04-30 09:11:57.916 INFO  [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
2025-04-30 09:11:57.916 INFO  [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-04-30 09:11:57.921 INFO  [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 4 ms. Found 1 JPA repository interface.
2025-04-30 09:11:57.927 INFO  [main] beddedDataSourceBeanFactoryPostProcessor : Replacing 'dataSource' DataSource bean with embedded version
2025-04-30 09:11:57.936 INFO  [main] o.s.j.d.e.EmbeddedDatabaseFactory        : Starting embedded database: url='jdbc:h2:mem:d2bd8258-fa39-491e-81d8-b612d3699f44;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=false', username='sa'
2025-04-30 09:11:58.042 INFO  [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2025-04-30 09:11:58.043 INFO  [main] o.h.c.internal.RegionFactoryInitiator    : HHH000026: Second-level cache disabled
2025-04-30 09:11:58.049 INFO  [main] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2025-04-30 09:11:58.053 WARN  [main] org.hibernate.dialect.Dialect            : HHH000511: The 2.3.232 version for [org.hibernate.dialect.PostgreSQLDialect] is no longer supported, hence certain features may not work properly. The minimum supported version is 12.0.0. Check the community dialects project for available legacy versions.
2025-04-30 09:11:58.053 WARN  [main] org.hibernate.orm.deprecation            : HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-04-30 09:11:58.056 INFO  [main] org.hibernate.orm.connections.pooling    : HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'org.springframework.jdbc.datasource.embedded.EmbeddedDatabaseFactory$EmbeddedDataSourceProxy@6c238208']
	Database driver: undefined/unknown
	Database version: 2.3.232
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-04-30 09:11:58.073 INFO  [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-04-30 09:11:58.095 INFO  [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-04-30 09:11:58.116 INFO  [main] c.i.b.s.r.AccountRepositoryTest          : Started AccountRepositoryTest in 0.244 seconds (process running for 4.637)
2025-04-30 09:11:58.239 INFO  [main] o.s.mock.web.MockServletContext          : Initializing Spring TestDispatcherServlet ''
2025-04-30 09:11:58.239 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-04-30 09:11:58.239 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 0 ms
2025-04-30 09:11:58.242 ERROR [main] c.i.b.s.e.GlobalExceptionHandler         : Unhandled Exception: Unexpected database error
java.lang.RuntimeException: Unexpected database error
	at com.ibrahim.banking.store_of_value_service.service.AccountService.activateAccount(AccountService.java:67)
	at com.ibrahim.banking.store_of_value_service.controller.AccountController.activateAccount(AccountController.java:51)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:888)
	at org.springframework.test.web.servlet.TestDispatcherServlet.service(TestDispatcherServlet.java:72)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.springframework.mock.web.MockFilterChain$ServletFilterProxy.doFilter(MockFilterChain.java:165)
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:132)
	at org.springframework.test.web.servlet.MockMvc.perform(MockMvc.java:201)
	at com.ibrahim.banking.store_of_value_service.controller.AccountControllerWithExceptionHandlerTest.activateAccount_ServerError_ShouldReturnProperErrorResponse(AccountControllerWithExceptionHandlerTest.java:153)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:767)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:156)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:147)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:86)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(InterceptingExecutableInvoker.java:103)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.lambda$invoke$0(InterceptingExecutableInvoker.java:93)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:92)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:86)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$8(TestMethodTestDescriptor.java:217)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:213)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:138)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:68)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:156)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1597)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:160)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1597)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:160)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:198)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:169)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:93)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:58)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:141)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:57)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:103)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:85)
	at org.junit.platform.launcher.core.DelegatingLauncher.execute(DelegatingLauncher.java:47)
	at org.junit.platform.launcher.core.SessionPerRequestLauncher.execute(SessionPerRequestLauncher.java:63)
	at com.intellij.junit5.JUnit5IdeaTestRunner.startRunnerWithArgs(JUnit5IdeaTestRunner.java:57)
	at com.intellij.rt.junit.IdeaTestRunner$Repeater$1.execute(IdeaTestRunner.java:38)
	at com.intellij.rt.execution.junit.TestsRepeater.repeat(TestsRepeater.java:11)
	at com.intellij.rt.junit.IdeaTestRunner$Repeater.startRunnerWithArgs(IdeaTestRunner.java:35)
	at com.intellij.rt.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:232)
	at com.intellij.rt.junit.JUnitStarter.main(JUnitStarter.java:55)
2025-04-30 09:11:58.252 INFO  [main] o.s.mock.web.MockServletContext          : Initializing Spring TestDispatcherServlet ''
2025-04-30 09:11:58.252 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-04-30 09:11:58.252 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 0 ms
2025-04-30 09:11:58.255 ERROR [main] c.i.b.s.e.GlobalExceptionHandler         : AccountNotFoundException: Account not found with number: nonexistent
2025-04-30 09:11:58.262 INFO  [main] o.s.mock.web.MockServletContext          : Initializing Spring TestDispatcherServlet ''
2025-04-30 09:11:58.263 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-04-30 09:11:58.263 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 0 ms
2025-04-30 09:11:58.267 ERROR [main] c.i.b.s.e.GlobalExceptionHandler         : MethodArgumentNotValidException: Validation failed: {accountType=Account type cannot be null}
2025-04-30 09:11:58.273 INFO  [main] o.s.mock.web.MockServletContext          : Initializing Spring TestDispatcherServlet ''
2025-04-30 09:11:58.274 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-04-30 09:11:58.274 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 0 ms
2025-04-30 09:11:58.277 ERROR [main] c.i.b.s.e.GlobalExceptionHandler         : MethodArgumentNotValidException: Validation failed: {profileId=Profile ID cannot be blank, accountType=Account type cannot be null}
2025-04-30 09:11:58.284 INFO  [main] o.s.mock.web.MockServletContext          : Initializing Spring TestDispatcherServlet ''
2025-04-30 09:11:58.284 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-04-30 09:11:58.284 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 0 ms
2025-04-30 09:11:58.286 ERROR [main] c.i.b.s.e.GlobalExceptionHandler         : Unhandled Exception: Account is not active.
java.lang.IllegalStateException: Account is not active.
	at com.ibrahim.banking.store_of_value_service.service.AccountService.getBalance(AccountService.java:52)
	at com.ibrahim.banking.store_of_value_service.controller.AccountController.getBalance(AccountController.java:44)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at org.springframework.test.web.servlet.TestDispatcherServlet.service(TestDispatcherServlet.java:72)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.springframework.mock.web.MockFilterChain$ServletFilterProxy.doFilter(MockFilterChain.java:165)
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:132)
	at org.springframework.test.web.servlet.MockMvc.perform(MockMvc.java:201)
	at com.ibrahim.banking.store_of_value_service.controller.AccountControllerWithExceptionHandlerTest.getBalance_IllegalState_ShouldReturnProperErrorResponse(AccountControllerWithExceptionHandlerTest.java:112)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:767)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:156)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:147)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:86)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(InterceptingExecutableInvoker.java:103)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.lambda$invoke$0(InterceptingExecutableInvoker.java:93)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:92)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:86)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$8(TestMethodTestDescriptor.java:217)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:213)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:138)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:68)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:156)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1597)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:160)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1597)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:160)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:198)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:169)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:93)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:58)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:141)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:57)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:103)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:85)
	at org.junit.platform.launcher.core.DelegatingLauncher.execute(DelegatingLauncher.java:47)
	at org.junit.platform.launcher.core.SessionPerRequestLauncher.execute(SessionPerRequestLauncher.java:63)
	at com.intellij.junit5.JUnit5IdeaTestRunner.startRunnerWithArgs(JUnit5IdeaTestRunner.java:57)
	at com.intellij.rt.junit.IdeaTestRunner$Repeater$1.execute(IdeaTestRunner.java:38)
	at com.intellij.rt.execution.junit.TestsRepeater.repeat(TestsRepeater.java:11)
	at com.intellij.rt.junit.IdeaTestRunner$Repeater.startRunnerWithArgs(IdeaTestRunner.java:35)
	at com.intellij.rt.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:232)
	at com.intellij.rt.junit.JUnitStarter.main(JUnitStarter.java:55)
2025-04-30 09:11:58.305 INFO  [SpringApplicationShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2025-04-30 09:11:58.307 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2025-04-30 09:11:58.308 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2025-04-30 09:11:58.309 INFO  [SpringApplicationShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2025-04-30 09:13:29.058 INFO  [main] t.c.s.AnnotationConfigContextLoaderUtils : Could not detect default configuration classes for test class [com.ibrahim.banking.store_of_value_service.repository.AccountRepositoryTest]: AccountRepositoryTest does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2025-04-30 09:13:29.135 INFO  [main] .b.t.c.SpringBootTestContextBootstrapper : Found @SpringBootConfiguration com.ibrahim.banking.store_of_value_service.StoreOfValueServiceApplication for test class com.ibrahim.banking.store_of_value_service.repository.AccountRepositoryTest
2025-04-30 09:13:29.299 INFO  [background-preinit] o.h.validator.internal.util.Version      : HV000001: Hibernate Validator 8.0.2.Final
2025-04-30 09:13:29.325 INFO  [main] c.i.b.s.r.AccountRepositoryTest          : Starting AccountRepositoryTest using Java 17.0.7 with PID 47146 (started by ibrahimdiba in /Users/ibrahimdiba/Desktop/Projects/banking-system/store-of-value-service)
2025-04-30 09:13:29.325 INFO  [main] c.i.b.s.r.AccountRepositoryTest          : No active profile set, falling back to 1 default profile: "default"
2025-04-30 09:13:29.508 INFO  [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
2025-04-30 09:13:29.509 INFO  [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-04-30 09:13:29.601 INFO  [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 82 ms. Found 1 JPA repository interface.
2025-04-30 09:13:29.629 INFO  [main] beddedDataSourceBeanFactoryPostProcessor : Replacing 'dataSource' DataSource bean with embedded version
2025-04-30 09:13:29.675 INFO  [main] o.s.j.d.e.EmbeddedDatabaseFactory        : Starting embedded database: url='jdbc:h2:mem:b51c1a0b-da81-4f21-ae1d-d57d78201c23;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=false', username='sa'
2025-04-30 09:13:29.830 INFO  [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2025-04-30 09:13:29.863 INFO  [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.6.13.Final
2025-04-30 09:13:29.880 INFO  [main] o.h.c.internal.RegionFactoryInitiator    : HHH000026: Second-level cache disabled
2025-04-30 09:13:30.024 INFO  [main] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2025-04-30 09:13:30.063 WARN  [main] org.hibernate.dialect.Dialect            : HHH000511: The 2.3.232 version for [org.hibernate.dialect.PostgreSQLDialect] is no longer supported, hence certain features may not work properly. The minimum supported version is 12.0.0. Check the community dialects project for available legacy versions.
2025-04-30 09:13:30.067 WARN  [main] org.hibernate.orm.deprecation            : HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-04-30 09:13:30.079 INFO  [main] org.hibernate.orm.connections.pooling    : HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'org.springframework.jdbc.datasource.embedded.EmbeddedDatabaseFactory$EmbeddedDataSourceProxy@2ff498b0']
	Database driver: undefined/unknown
	Database version: 2.3.232
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-04-30 09:13:30.523 INFO  [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-04-30 09:13:30.559 INFO  [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-04-30 09:13:30.749 INFO  [main] c.i.b.s.r.AccountRepositoryTest          : Started AccountRepositoryTest in 1.576 seconds (process running for 2.155)
2025-04-30 09:13:31.251 INFO  [main] t.c.s.AnnotationConfigContextLoaderUtils : Could not detect default configuration classes for test class [com.ibrahim.banking.store_of_value_service.StoreOfValueServiceApplicationTests]: StoreOfValueServiceApplicationTests does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2025-04-30 09:13:31.256 INFO  [main] .b.t.c.SpringBootTestContextBootstrapper : Found @SpringBootConfiguration com.ibrahim.banking.store_of_value_service.StoreOfValueServiceApplication for test class com.ibrahim.banking.store_of_value_service.StoreOfValueServiceApplicationTests
2025-04-30 09:13:31.286 INFO  [main] .b.s.StoreOfValueServiceApplicationTests : Starting StoreOfValueServiceApplicationTests using Java 17.0.7 with PID 47146 (started by ibrahimdiba in /Users/ibrahimdiba/Desktop/Projects/banking-system/store-of-value-service)
2025-04-30 09:13:31.286 INFO  [main] .b.s.StoreOfValueServiceApplicationTests : No active profile set, falling back to 1 default profile: "default"
2025-04-30 09:13:31.512 INFO  [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
2025-04-30 09:13:31.512 INFO  [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-04-30 09:13:31.518 INFO  [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 4 ms. Found 1 JPA repository interface.
2025-04-30 09:13:31.524 INFO  [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
2025-04-30 09:13:31.525 INFO  [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-04-30 09:13:31.533 INFO  [main] .RepositoryConfigurationExtensionSupport : Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.ibrahim.banking.store_of_value_service.repository.AccountRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-04-30 09:13:31.533 INFO  [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 2 ms. Found 0 Redis repository interfaces.
2025-04-30 09:13:31.699 INFO  [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2025-04-30 09:13:31.700 INFO  [main] o.h.c.internal.RegionFactoryInitiator    : HHH000026: Second-level cache disabled
2025-04-30 09:13:31.706 INFO  [main] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2025-04-30 09:13:31.707 INFO  [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-04-30 09:13:31.865 INFO  [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@438a2337
2025-04-30 09:13:31.867 INFO  [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-04-30 09:13:31.884 WARN  [main] org.hibernate.orm.deprecation            : HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-04-30 09:13:31.892 INFO  [main] org.hibernate.orm.connections.pooling    : HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 14.17
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-04-30 09:13:31.912 INFO  [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-04-30 09:13:31.935 INFO  [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-04-30 09:13:32.055 WARN  [main] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-04-30 09:13:32.803 INFO  [main] .b.s.StoreOfValueServiceApplicationTests : Started StoreOfValueServiceApplicationTests in 1.537 seconds (process running for 4.21)
2025-04-30 09:13:32.956 INFO  [main] o.s.mock.web.MockServletContext          : Initializing Spring TestDispatcherServlet ''
2025-04-30 09:13:32.957 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-04-30 09:13:32.957 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 0 ms
2025-04-30 09:13:33.024 ERROR [main] c.i.b.s.e.GlobalExceptionHandler         : Unhandled Exception: Unexpected database error
java.lang.RuntimeException: Unexpected database error
	at com.ibrahim.banking.store_of_value_service.service.AccountService.activateAccount(AccountService.java:67)
	at com.ibrahim.banking.store_of_value_service.controller.AccountController.activateAccount(AccountController.java:51)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:888)
	at org.springframework.test.web.servlet.TestDispatcherServlet.service(TestDispatcherServlet.java:72)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.springframework.mock.web.MockFilterChain$ServletFilterProxy.doFilter(MockFilterChain.java:165)
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:132)
	at org.springframework.test.web.servlet.MockMvc.perform(MockMvc.java:201)
	at com.ibrahim.banking.store_of_value_service.controller.AccountControllerWithExceptionHandlerTest.activateAccount_ServerError_ShouldReturnProperErrorResponse(AccountControllerWithExceptionHandlerTest.java:136)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:767)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:156)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:147)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:86)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(InterceptingExecutableInvoker.java:103)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.lambda$invoke$0(InterceptingExecutableInvoker.java:93)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:92)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:86)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$8(TestMethodTestDescriptor.java:217)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:213)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:138)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:68)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:156)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:160)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:160)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:198)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:169)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:93)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:58)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:141)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:57)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:103)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:85)
	at org.junit.platform.launcher.core.DelegatingLauncher.execute(DelegatingLauncher.java:47)
	at org.apache.maven.surefire.junitplatform.LazyLauncher.execute(LazyLauncher.java:56)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.execute(JUnitPlatformProvider.java:194)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:150)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:124)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:385)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:162)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:507)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:495)
2025-04-30 09:13:33.114 INFO  [main] o.s.mock.web.MockServletContext          : Initializing Spring TestDispatcherServlet ''
2025-04-30 09:13:33.114 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-04-30 09:13:33.115 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 0 ms
2025-04-30 09:13:33.120 ERROR [main] c.i.b.s.e.GlobalExceptionHandler         : AccountNotFoundException: Account not found with number: nonexistent
2025-04-30 09:13:33.143 INFO  [main] o.s.mock.web.MockServletContext          : Initializing Spring TestDispatcherServlet ''
2025-04-30 09:13:33.143 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-04-30 09:13:33.143 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 0 ms
2025-04-30 09:13:33.212 ERROR [main] c.i.b.s.e.GlobalExceptionHandler         : MethodArgumentNotValidException: Validation failed: {accountType=Account type cannot be null}
2025-04-30 09:13:33.237 INFO  [main] o.s.mock.web.MockServletContext          : Initializing Spring TestDispatcherServlet ''
2025-04-30 09:13:33.237 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-04-30 09:13:33.238 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 0 ms
2025-04-30 09:13:33.248 ERROR [main] c.i.b.s.e.GlobalExceptionHandler         : MethodArgumentNotValidException: Validation failed: {profileId=Profile ID cannot be blank, accountType=Account type cannot be null}
2025-04-30 09:13:33.264 INFO  [main] o.s.mock.web.MockServletContext          : Initializing Spring TestDispatcherServlet ''
2025-04-30 09:13:33.265 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-04-30 09:13:33.265 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 0 ms
2025-04-30 09:13:33.288 INFO  [main] o.s.mock.web.MockServletContext          : Initializing Spring TestDispatcherServlet ''
2025-04-30 09:13:33.288 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-04-30 09:13:33.288 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 0 ms
2025-04-30 09:13:33.302 INFO  [main] o.s.mock.web.MockServletContext          : Initializing Spring TestDispatcherServlet ''
2025-04-30 09:13:33.302 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-04-30 09:13:33.303 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 0 ms
2025-04-30 09:13:33.319 INFO  [main] o.s.mock.web.MockServletContext          : Initializing Spring TestDispatcherServlet ''
2025-04-30 09:13:33.319 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-04-30 09:13:33.319 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 0 ms
2025-04-30 09:13:33.334 INFO  [main] o.s.mock.web.MockServletContext          : Initializing Spring TestDispatcherServlet ''
2025-04-30 09:13:33.335 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-04-30 09:13:33.335 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 0 ms
2025-04-30 09:13:33.341 WARN  [main] .w.s.m.s.DefaultHandlerExceptionResolver : Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<com.ibrahim.banking.store_of_value_service.dto.AccountResponse> com.ibrahim.banking.store_of_value_service.controller.AccountController.createAccount(com.ibrahim.banking.store_of_value_service.dto.CreateAccountRequest) with 2 errors: [Field error in object 'createAccountRequest' on field 'accountType': rejected value [null]; codes [NotNull.createAccountRequest.accountType,NotNull.accountType,NotNull.com.ibrahim.banking.store_of_value_service.model.AccountType,NotNull]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [createAccountRequest.accountType,accountType]; arguments []; default message [accountType]]; default message [Account type cannot be null]] [Field error in object 'createAccountRequest' on field 'profileId': rejected value [null]; codes [NotBlank.createAccountRequest.profileId,NotBlank.profileId,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [createAccountRequest.profileId,profileId]; arguments []; default message [profileId]]; default message [Profile ID cannot be blank]] ]
2025-04-30 09:13:33.351 INFO  [main] o.s.mock.web.MockServletContext          : Initializing Spring TestDispatcherServlet ''
2025-04-30 09:13:33.351 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-04-30 09:13:33.351 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 0 ms
2025-04-30 09:13:33.368 INFO  [main] o.s.mock.web.MockServletContext          : Initializing Spring TestDispatcherServlet ''
2025-04-30 09:13:33.368 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-04-30 09:13:33.368 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 0 ms
2025-04-30 09:13:33.380 INFO  [main] o.s.mock.web.MockServletContext          : Initializing Spring TestDispatcherServlet ''
2025-04-30 09:13:33.380 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-04-30 09:13:33.380 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 0 ms
2025-04-30 09:13:33.391 INFO  [main] o.s.mock.web.MockServletContext          : Initializing Spring TestDispatcherServlet ''
2025-04-30 09:13:33.391 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-04-30 09:13:33.391 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 0 ms
2025-04-30 09:13:33.404 INFO  [main] o.s.mock.web.MockServletContext          : Initializing Spring TestDispatcherServlet ''
2025-04-30 09:13:33.404 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-04-30 09:13:33.404 INFO  [main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 0 ms
2025-04-30 09:13:33.509 INFO  [main] c.i.b.s.service.AccountService           : Attempting to update account type for account number: 1112223330
2025-04-30 09:13:33.510 ERROR [main] c.i.b.s.service.AccountService           : Cannot update account 1112223330 because it is closed.
2025-04-30 09:13:33.513 INFO  [main] c.i.b.s.service.AccountService           : Attempting to activate account number: 1112223330
2025-04-30 09:13:33.513 ERROR [main] c.i.b.s.service.AccountService           : Cannot activate account 1112223330 in state: INACTIVE
2025-04-30 09:13:33.515 INFO  [main] c.i.b.s.service.AccountService           : Attempting to update account type for account number: 1112223330
2025-04-30 09:13:33.515 INFO  [main] c.i.b.s.service.AccountService           : Account 1112223330 updated successfully.
2025-04-30 09:13:33.518 INFO  [main] c.i.b.s.service.AccountService           : Attempting to deactivate account number: 1112223330
2025-04-30 09:13:33.518 INFO  [main] c.i.b.s.service.AccountService           : Account 1112223330 deactivated successfully.
2025-04-30 09:13:33.522 INFO  [main] c.i.b.s.service.AccountService           : Attempting to create account for profileId: profile-new
2025-04-30 09:13:33.522 INFO  [main] c.i.b.s.service.AccountService           : Generated unique account number: 7529558031
2025-04-30 09:13:33.522 INFO  [main] c.i.b.s.service.AccountService           : Account created successfully with ID: 99 and Number: 7529558031
2025-04-30 09:13:33.524 INFO  [main] c.i.b.s.service.AccountService           : Attempting to activate account number: 1112223330
2025-04-30 09:13:33.524 INFO  [main] c.i.b.s.service.AccountService           : Account 1112223330 activated successfully.
2025-04-30 09:13:33.525 INFO  [main] c.i.b.s.service.AccountService           : Attempting to deactivate account number: 1112223330
2025-04-30 09:13:33.525 WARN  [main] c.i.b.s.service.AccountService           : Account 1112223330 is already inactive. Returning current state.
2025-04-30 09:13:33.526 INFO  [main] c.i.b.s.service.AccountService           : Attempting to activate account number: 1112223330
2025-04-30 09:13:33.527 WARN  [main] c.i.b.s.service.AccountService           : Account 1112223330 is already active. Returning current state.
2025-04-30 09:13:33.528 INFO  [main] c.i.b.s.service.AccountService           : Attempting to activate account number: 0000000000
2025-04-30 09:13:33.534 INFO  [main] c.i.b.s.service.AccountService           : Attempting to deactivate account number: 0000000000
2025-04-30 09:13:33.536 INFO  [main] c.i.b.s.service.AccountService           : Attempting to deactivate account number: 1112223330
2025-04-30 09:13:33.537 ERROR [main] c.i.b.s.service.AccountService           : Cannot deactivate account 1112223330 in state: PENDING_ACTIVATION
2025-04-30 09:13:33.540 INFO  [main] c.i.b.s.service.AccountService           : Attempting to update account type for account number: 0000000000
2025-04-30 09:13:33.555 INFO  [SpringApplicationShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2025-04-30 09:13:33.567 INFO  [SpringApplicationShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2025-04-30 09:13:33.567 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2025-04-30 09:13:33.569 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
